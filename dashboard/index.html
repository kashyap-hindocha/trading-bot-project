<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ALGO DESK â€” Trading Bot</title>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">
  
  <!-- Chart.js Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
  
  <!-- Lightweight Charts (TradingView) -->
  <script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<!-- HEADER -->
<header>
  <div class="logo">ALGO<span>/</span>DESK</div>
  <div class="header-right">
    <div class="last-update" id="lastUpdate">â€”</div>
    <div class="status-pill">
      <div class="dot" id="statusDot"></div>
      <span id="statusText">CHECKING</span>
    </div>
    <button class="mode-btn" id="modeBtn" onclick="toggleMode()" disabled>
      MODE: â€”
    </button>
    <button class="toggle-btn start" id="toggleBtn" onclick="toggleBot()" disabled>
      â³ Loading
    </button>
  </div>
</header>

<!-- MAIN CONTENT -->
<main>
  <!-- Stats Row 1 -->
  <div class="stat-row">
    <div class="card accent">
      <div class="card-label">Wallet Balance</div>
      <div class="card-value accent" id="balance">â€”</div>
      <div class="card-sub" id="balanceSub">Futures wallet</div>
    </div>
    <div class="card green">
      <div class="card-label">Total PnL</div>
      <div class="card-value" id="totalPnl">â€”</div>
      <div class="card-sub">closed trades</div>
    </div>
    <div class="card">
      <div class="card-label">Win Rate</div>
      <div class="card-value" id="winRate">â€”</div>
      <div class="card-sub" id="winsLosses">â€” wins / â€” losses</div>
    </div>
    <div class="card yellow">
      <div class="card-label">Open Positions</div>
      <div class="card-value" id="openPositions">â€”</div>
      <div class="card-sub" id="totalTrades">â€” total trades</div>
    </div>
  </div>

  <!-- Stats Row 2 (Paper Trading) -->
  <div class="stat-row">
    <div class="card accent">
      <div class="card-label">Paper Balance</div>
      <div class="card-value accent" id="paperBalance">â€”</div>
      <div class="card-sub">paper wallet</div>
      <button class="mini-btn" onclick="resetPaperBalance()">Reset Paper Balance</button>
    </div>
    <div class="card green">
      <div class="card-label">Paper PnL</div>
      <div class="card-value" id="paperTotalPnl">â€”</div>
      <div class="card-sub">closed paper trades</div>
    </div>
    <div class="card">
      <div class="card-label">Paper Win Rate</div>
      <div class="card-value" id="paperWinRate">â€”</div>
      <div class="card-sub" id="paperWinsLosses">â€” wins / â€” losses</div>
    </div>
    <div class="card yellow">
      <div class="card-label">Paper Open</div>
      <div class="card-value" id="paperOpenPositions">â€”</div>
      <div class="card-sub" id="paperTotalTrades">â€” total trades</div>
    </div>
  </div>

  <!-- Active Trading Pairs -->
  <div class="active-pairs-section">
    <div class="panel-title">
      ğŸ“Š Active Trading Pairs
      <div class="panel-tools" style="font-size: 11px; color: var(--gray-2);">
        Real-time active trades
      </div>
    </div>
    <div id="activePairsContainer" style="display: flex; gap: 10px; flex-wrap: wrap;">
      <div style="color: var(--gray-2); font-size: 12px; padding: 10px;">No active trades</div>
    </div>
  </div>

  <!-- Open Trades Multi-View Section -->
  <div class="open-trades-section" style="display: none;">
    <div class="panel-title">
      ğŸ”„ Open Positions
      <div class="panel-tools">
        <select id="openTradesModeSelect" onchange="switchTradeMode()">
          <option value="real">Real Trades</option>
          <option value="paper">Paper Trades</option>
        </select>
      </div>
    </div>
    <div class="open-trades-tabs-container">
      <div id="openTradesTabs" style="display: flex; gap: 8px; margin-bottom: 12px; border-bottom: 1px solid var(--gray-3); padding-bottom: 8px; overflow-x: auto;"></div>
    </div>
    <div id="openTradesDetail" class="chart-panel" style="min-height: 200px; padding: 16px;">
      <div style="color: var(--gray-2); text-align: center; padding: 20px;">Select a trade to view details</div>
    </div>
  </div>

  <!-- Charts and Favorites Layout (70/30) -->
  <div class="charts-pairs-container">
    <div class="charts-section">
      <!-- Price Chart -->
      <div class="chart-panel wide">
        <div class="panel-title">
          ğŸ“Š Live Price â€” Pair Chart
          <div class="panel-tools">
            <select id="priceChartPairSelect" onchange="onPriceChartPairChange()" style="padding: 4px 8px; background: #1e2a35; color: #00e5ff; border: 1px solid #2a3a45; border-radius: 4px; font-family: Space Mono; font-size: 12px; min-width: 120px;">
              <option value="">Select Pair...</option>
            </select>
            <span id="priceChartInfo" style="color: #4a6070; font-size: 11px; margin-left: 12px;">Latest: â€”</span>
          </div>
        </div>
        <div class="chart-wrap"><canvas id="priceChart"></canvas></div>
      </div>

      <!-- Candlestick Chart -->
      <div class="chart-panel wide">
        <div class="panel-title">
          ğŸ•¯ï¸ Candlestick Chart (Interactive) â€” Threshold: 90%
          <div class="panel-tools">
            <select id="candlePairSelect" onchange="onCandlePairSelect()" style="padding: 4px 8px; background: #1e2a35; color: #00e5ff; border: 1px solid #2a3a45; border-radius: 4px; font-family: Space Mono; font-size: 12px; min-width: 120px;">
              <option value="">Select Pair...</option>
            </select>
            <select id="candleTimeframe" onchange="onTimeframeChange()" style="padding: 4px 8px; background: #1e2a35; color: #00e5ff; border: 1px solid #2a3a45; border-radius: 4px; font-family: Space Mono; font-size: 12px;">
              <option value="1m">1m</option>
              <option value="5m" selected>5m</option>
              <option value="15m">15m</option>
              <option value="1h">1h</option>
              <option value="4h">4h</option>
            </select>
            <span id="candleInfo" style="color: #4a6070; font-size: 11px; margin-left: 12px;">â€” Zoom: Wheel | Pan: Drag</span>
          </div>
        </div>
        <div id="candleChart" style="width: 100%; height: 400px; background: #0f1419;"></div>
      </div>

      <!-- Side-by-side Charts -->
      <div style="display: flex; gap: 16px;">
        <div class="chart-panel side">
          <div class="panel-title">Pair PnL</div>
          <div class="chart-wrap"><canvas id="pairPnlChart"></canvas></div>
        </div>

        <div class="chart-panel side">
          <div class="panel-title">PnL / Trade</div>
          <div class="chart-wrap"><canvas id="pnlChart"></canvas></div>
        </div>
      </div>

      <!-- Equity Chart -->
      <div class="chart-panel wide">
        <div class="panel-title">Equity Curve</div>
        <div class="chart-wrap"><canvas id="equityChart"></canvas></div>
      </div>
    </div>

    <!-- Favorites Panel (Right Side) -->
    <div class="pairs-section">
      <div class="chart-panel" style="flex: 1; overflow-y: auto;">
        <div class="panel-title">â­ Favorites</div>
        <div id="favoritesPanel" style="display: flex; flex-direction: column; gap: 6px; font-size: 12px;"></div>
      </div>
    </div>
  </div>

  <!-- Coin Manager â€” Pair Listing (Sorted by Confidence) -->
  <div class="coin-manager">
    <div class="panel-title">
      ğŸ“ˆ All Pairs (Sorted by Confidence - Closest to 90% First)
      <div class="panel-tools">
        <input type="text" id="pairSearch" placeholder="Search pairs..." oninput="onPairsPageChange()">
        <select id="pairListLimit" onchange="onPairsPageChange()">
          <option value="10">Top 10</option>
          <option value="20">Top 20</option>
          <option value="30">Top 30</option>
          <option value="50" selected>Top 50</option>
          <option value="100">Top 100</option>
          <option value="1000">All</option>
        </select>
      </div>
    </div>
    <div class="coin-grid" id="coinGrid">
      <div class="loading">Loading available pairs...</div>
    </div>
  </div>

  <!-- Trade History Table -->
  <div class="table-panel">
    <div class="panel-title">Trade History</div>
    <table>
      <thead>
        <tr>
          <th>Pair</th><th>Side</th><th>Entry</th><th>Exit</th>
          <th>TP</th><th>SL</th><th>Qty</th><th>Lev</th>
          <th>PnL</th><th>Status</th><th>Opened</th>
        </tr>
      </thead>
      <tbody id="tradesBody">
        <tr><td colspan="11" class="loading">Loading trades...</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Paper Trade History Table -->
  <div class="table-panel">
    <div class="panel-title">Paper Trade History</div>
    <table>
      <thead>
        <tr>
          <th>Pair</th><th>Side</th><th>Entry</th><th>Exit</th>
          <th>TP</th><th>SL</th><th>Qty</th><th>Lev</th>
          <th>PnL</th><th>Status</th><th>Opened</th>
        </tr>
      </thead>
      <tbody id="paperTradesBody">
        <tr><td colspan="11" class="loading">Loading paper trades...</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Bot Logs -->
  <div class="logs-panel">
    <div class="panel-title">Bot Logs</div>
    <div class="log-list" id="logList">
      <div class="loading">Loading logs...</div>
    </div>
  </div>
</main>

<!-- Toast Notification -->
<div class="toast" id="toast"></div>

<!-- Scripts (in order of dependency) -->
<script src="js/app.js"></script>
<script src="js/charts.js"></script>
<script src="js/candlestick.js"></script>
<script src="js/data.js"></script>
<script src="js/ui.js"></script>
<script src="js/init.js"></script>

</body>
</html>
