<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ALGO DESK — Trading Bot</title>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">
  
  <!-- Chart.js Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<!-- HEADER -->
<header>
  <div class="logo">ALGO<span>/</span>DESK</div>
  <div class="header-right">
    <div class="last-update" id="lastUpdate">—</div>
    <div class="status-pill">
      <div class="dot" id="statusDot"></div>
      <span id="statusText">CHECKING</span>
    </div>
    <button class="mode-btn" id="modeBtn" onclick="toggleMode()" disabled>
      MODE: —
    </button>
    <button class="toggle-btn start" id="toggleBtn" onclick="toggleBot()" disabled>
      ⏳ Loading
    </button>
  </div>
</header>

<!-- MAIN CONTENT -->
<main>
  <!-- Stats Row 1 -->
  <div class="stat-row">
    <div class="card accent">
      <div class="card-label">Wallet Balance</div>
      <div class="card-value accent" id="balance">—</div>
      <div class="card-sub" id="balanceSub">Futures wallet</div>
    </div>
    <div class="card green">
      <div class="card-label">Total PnL</div>
      <div class="card-value" id="totalPnl">—</div>
      <div class="card-sub">closed trades</div>
    </div>
    <div class="card">
      <div class="card-label">Win Rate</div>
      <div class="card-value" id="winRate">—</div>
      <div class="card-sub" id="winsLosses">— wins / — losses</div>
    </div>
    <div class="card yellow">
      <div class="card-label">Open Positions</div>
      <div class="card-value" id="openPositions">—</div>
      <div class="card-sub" id="totalTrades">— total trades</div>
    </div>
  </div>

  <!-- Stats Row 2 (Paper Trading) -->
  <div class="stat-row">
    <div class="card accent">
      <div class="card-label">Paper Balance</div>
      <div class="card-value accent" id="paperBalance">—</div>
      <div class="card-sub">paper wallet</div>
      <button class="mini-btn" onclick="resetPaperBalance()">Reset Paper Balance</button>
    </div>
    <div class="card green">
      <div class="card-label">Paper PnL</div>
      <div class="card-value" id="paperTotalPnl">—</div>
      <div class="card-sub">closed paper trades</div>
    </div>
    <div class="card">
      <div class="card-label">Paper Win Rate</div>
      <div class="card-value" id="paperWinRate">—</div>
      <div class="card-sub" id="paperWinsLosses">— wins / — losses</div>
    </div>
    <div class="card yellow">
      <div class="card-label">Paper Open</div>
      <div class="card-value" id="paperOpenPositions">—</div>
      <div class="card-sub" id="paperTotalTrades">— total trades</div>
    </div>
  </div>

  <!-- Coin Manager -->
  <div class="coin-manager">
    <div class="panel-title">
      Coin Manager — Select pairs to trade
      <div class="panel-tools">
        <input type="text" id="pairSearch" placeholder="Search pairs..." oninput="renderPairs()">
        <select id="pairListLimit" onchange="renderPairs()">
          <option value="10">Show 10</option>
          <option value="20">Show 20</option>
          <option value="30">Show 30</option>
          <option value="40">Show 40</option>
          <option value="50">Show 50</option>
          <option value="60">Show 60</option>
          <option value="70">Show 70</option>
          <option value="80">Show 80</option>
          <option value="90">Show 90</option>
          <option value="100">Show 100</option>
          <option value="1000">Show All</option>
        </select>
      </div>
    </div>
    <div class="coin-grid" id="coinGrid">
      <div class="loading">Loading available pairs...</div>
    </div>
    <button class="apply-btn" id="applyCoinsBtn" onclick="applyPairChanges()" disabled>Apply Changes & Restart Bots</button>
  </div>

  <!-- Charts and Pairs Layout -->
  <div class="charts-pairs-container">
    <div class="charts-section">
      <!-- Price Chart -->
      <div class="chart-panel wide">
        <div class="panel-title">
          Live Price — Selected Pair
          <div class="panel-tools">
            <select id="pairSelect" onchange="onPairChange()"></select>
          </div>
        </div>
        <div class="chart-wrap"><canvas id="priceChart"></canvas></div>
      </div>

      <!-- Side-by-side Charts -->
      <div style="display: flex; gap: 16px;">
        <div class="chart-panel side">
          <div class="panel-title">Pair PnL</div>
          <div class="chart-wrap"><canvas id="pairPnlChart"></canvas></div>
        </div>

        <div class="chart-panel side">
          <div class="panel-title">PnL / Trade</div>
          <div class="chart-wrap"><canvas id="pnlChart"></canvas></div>
        </div>
      </div>

      <!-- Equity Chart -->
      <div class="chart-panel wide">
        <div class="panel-title">Equity Curve</div>
        <div class="chart-wrap"><canvas id="equityChart"></canvas></div>
      </div>
    </div>

    <!-- Favorites & Pairs Panel -->
    <div class="pairs-section">
      <div class="chart-panel" style="flex: 1; overflow-y: auto;">
        <div class="panel-title">Favorites & Pairs</div>
        <div id="pairsListPanel" style="display: flex; flex-direction: column; gap: 8px;"></div>
      </div>
    </div>
  </div>

  <!-- Trade History Table -->
  <div class="table-panel">
    <div class="panel-title">Trade History</div>
    <table>
      <thead>
        <tr>
          <th>Pair</th><th>Side</th><th>Entry</th><th>Exit</th>
          <th>TP</th><th>SL</th><th>Qty</th><th>Lev</th>
          <th>PnL</th><th>Status</th><th>Opened</th>
        </tr>
      </thead>
      <tbody id="tradesBody">
        <tr><td colspan="11" class="loading">Loading trades...</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Paper Trade History Table -->
  <div class="table-panel">
    <div class="panel-title">Paper Trade History</div>
    <table>
      <thead>
        <tr>
          <th>Pair</th><th>Side</th><th>Entry</th><th>Exit</th>
          <th>TP</th><th>SL</th><th>Qty</th><th>Lev</th>
          <th>PnL</th><th>Status</th><th>Opened</th>
        </tr>
      </thead>
      <tbody id="paperTradesBody">
        <tr><td colspan="11" class="loading">Loading paper trades...</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Bot Logs -->
  <div class="logs-panel">
    <div class="panel-title">Bot Logs</div>
    <div class="log-list" id="logList">
      <div class="loading">Loading logs...</div>
    </div>
  </div>
</main>

<!-- Toast Notification -->
<div class="toast" id="toast"></div>

<!-- Scripts (in order of dependency) -->
<script src="js/app.js"></script>
<script src="js/charts.js"></script>
<script src="js/data.js"></script>
<script src="js/ui.js"></script>
<script src="js/init.js"></script>

</body>
</html>
